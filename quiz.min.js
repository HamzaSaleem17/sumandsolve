(function(){ if (typeof document === 'undefined') return; const scoreEl = document.getElementById('score'); const levelEl = document.getElementById('level'); const askedEl = document.getElementById('totalQuestions') || document.getElementById('questionCount'); const feedbackEl = document.getElementById('feedback'); window.__sums_enforcer__ = window.__sums_enforcer__ || {}; const S = window.__sums_enforcer__; S.questionsInLevel = 0; S.correctInLevel = 0; S.maxPerLevel = 20; S.pointsCorrect = 5; S.pointsWrong = -2; function setText(node, txt){ if (node) node.textContent = txt; } function toast(msg, ok){ if (feedbackEl){ feedbackEl.textContent = msg; feedbackEl.classList.remove('bad','ok'); feedbackEl.classList.add(ok ? 'ok':'bad'); setTimeout(()=>{ feedbackEl.textContent=''; }, 1500); } } const _gen = window.generateQuestion; window.generateQuestion = function(){ if (typeof _gen === 'function'){ _gen(); } S.questionsInLevel = (S.questionsInLevel||0); if (typeof window.totalQuestions !== 'undefined'){ } if (askedEl && typeof window.totalQuestions !== 'undefined'){ setText(askedEl, window.totalQuestions + "/20"); } }; const _chk = window.checkAnswer; window.checkAnswer = function(btn){ try{ const beforeScore = (typeof window.score !== 'undefined') ? window.score : 0; const selected = parseInt(btn && btn.textContent); const isCorrect = (window.currentQuestion && selected === window.currentQuestion.answer); if (typeof window.score === 'undefined') window.score = 0; if (isCorrect){ window.score += S.pointsCorrect; S.correctInLevel = (S.correctInLevel||0) + 1; toast("Correct! +5", true); } else { window.score += S.pointsWrong; toast("Oops! âˆ’2", false); } setText(scoreEl, window.score); S.questionsInLevel = (S.questionsInLevel||0) + 1; if (askedEl){ const q = (typeof window.totalQuestions !== 'undefined') ? window.totalQuestions : S.questionsInLevel; setText(askedEl, q + "/20"); } if (S.correctInLevel >= 20 || S.questionsInLevel >= 20){ if (typeof window.level === 'number'){ window.level += 1; setText(levelEl, window.level); } S.correctInLevel = 0; S.questionsInLevel = 0; if (typeof window.playSound === 'function'){ try{ window.playSound('levelUp'); }catch(e){} } } }catch(e){ console && console.warn && console.warn("Enforcer scoring error:", e); }finally{ if (typeof _chk === 'function'){ return _chk(btn); } } }; })();